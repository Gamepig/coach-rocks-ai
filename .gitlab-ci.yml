# GitLab CI/CD Pipeline - CoachRocks å°ˆæ¡ˆè½‰ç§»
# å®Œå…¨è‡ªå‹•åŒ–è½‰ç§»æµç¨‹ï¼Œç„¡éœ€æœ¬åœ°åŸ·è¡Œ
# æ›´æ–°æ™‚é–“ï¼š2025-11-19

stages:
  - phase_1_manual_prep
  - phase_2_automation
  - phase_3_oauth_resend
  - phase_4_database
  - phase_5_deployment

variables:
  # èˆŠå¸³æˆ¶ä¿¡æ¯ï¼ˆå·²çŸ¥ï¼‰
  OLD_OWNER: "gamepig1976@gmail.com"
  OLD_ACCOUNT_ID: "9288c023577aa2f6ce20582b6c4bdda0"
  OLD_DATABASE_ID: "d15ec66a-762c-40a2-bc8e-d64a1c8eb440"
  OLD_BACKEND_URL: "https://coach-backend.gamepig1976.workers.dev"

  # æ–°å¸³æˆ¶ä¿¡æ¯ï¼ˆéœ€è¦åœ¨è½‰ç§»æ™‚è¼¸å…¥ï¼‰
  NEW_OWNER: "katherine84522@gmail.com"
  # NEW_ACCOUNT_ID: åœ¨ Phase 1 å¾Œé€šé GitLab Variables æä¾›
  # NEW_DATABASE_ID: åœ¨ Phase 4 å¾Œé€šé GitLab Variables æä¾›
  # GOOGLE_CLIENT_ID: åœ¨ Phase 3 æ™‚é€šé GitLab Variables æä¾›
  # GOOGLE_CLIENT_SECRET: åœ¨ Phase 3 æ™‚é€šé GitLab Variables æä¾›

# ============================================================================
# PHASE 1: Cloudflare å¸³æˆ¶æº–å‚™ï¼ˆæ‰‹å‹•ï¼‰
# ============================================================================

phase_1_wait_for_cloudflare_setup:
  stage: phase_1_manual_prep
  image: alpine:latest
  script:
    - |
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘         Phase 1: Cloudflare å¸³æˆ¶æº–å‚™ï¼ˆKatherine æ‰‹å‹•ï¼‰        â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      echo ""
      echo "âš ï¸  è«‹åŸ·è¡Œä»¥ä¸‹æ‰‹å‹•æ­¥é©Ÿï¼š"
      echo ""
      echo "ğŸ“‹ Step 1: ç²å– Cloudflare Account ID"
      echo "   1. ç™»å…¥ https://dash.cloudflare.com"
      echo "   2. è¤‡è£½å³ä¸Šè§’çš„ Account ID"
      echo "   3. åœ¨ GitLab ä¸­æ·»åŠ  Variable: NEW_ACCOUNT_ID"
      echo "      è·¯å¾‘: Settings â†’ CI/CD â†’ Variables"
      echo ""
      echo "âš™ï¸  Step 2: å»ºç«‹ Cloudflare Workers"
      echo "   1. Cloudflare Dashboard â†’ Workers â†’ Create service"
      echo "   2. åç¨±ï¼šcoach-backend"
      echo "   3. è¨˜éŒ„ Worker URL: https://coach-backend.katherine84522.workers.dev"
      echo ""
      echo "ğŸ“¦ Step 3: å»ºç«‹ Cloudflare Pages"
      echo "   1. Cloudflare Dashboard â†’ Pages â†’ Create project"
      echo "   2. åç¨±ï¼šcoach-rocks-frontend"
      echo "   3. è¨˜éŒ„ Pages URL: https://coach-rocks-frontend.pages.dev"
      echo ""
      echo "âœ… å®Œæˆå¾Œï¼Œæ‰‹å‹•é»æ“Š 'Play' æŒ‰éˆ•ç¹¼çºŒä¸‹ä¸€å€‹ Jobï¼ˆPhase 2ï¼‰"
      echo ""
      echo "Cloudflare Account ID å·²è¨­ç½®: ${NEW_ACCOUNT_ID:-'âŒ æœªè¨­ç½®'}"
  when: manual
  allow_failure: false

# ============================================================================
# PHASE 2: è‡ªå‹•åŒ– URL å’Œé…ç½®æ›´æ–°
# ============================================================================

phase_2_batch_replace_urls:
  stage: phase_2_automation
  image: node:18-alpine
  needs: ["phase_1_wait_for_cloudflare_setup"]
  script:
    - |
      echo "Phase 2: AUTO_001 - æ‰¹é‡æ›´æ–°å¾Œç«¯ URL"

      # æª¢æŸ¥å¿…éœ€çš„ Variables
      if [ -z "$NEW_ACCOUNT_ID" ]; then
        echo "âŒ éŒ¯èª¤: NEW_ACCOUNT_ID æœªè¨­ç½®"
        exit 1
      fi

      NEW_BACKEND_URL="https://coach-backend.${NEW_OWNER%.com}.workers.dev"

      # æ‰¹é‡æ›¿æ› URLï¼ˆå…¼å®¹ macOS sed å’Œ Linux sedï¼‰
      find . -type f \( -name '*.ts' -o -name '*.tsx' -o -name '*.jsx' -o -name '*.js' -o -name '*.jsonc' -o -name '.dev.vars' -o -name '.env.*' \) \
        ! -path '*/.git/*' \
        ! -path '*/node_modules/*' \
        ! -path '*/.wrangler/*' \
        ! -path '*/technical_docs/*' \
        -print0 | xargs -0 sed -i.bak "s|https://coach-backend\.gamepig1976\.workers\.dev|${NEW_BACKEND_URL}|g"

      # æ¸…ç†å‚™ä»½æ–‡ä»¶
      find . -name '*.bak' -delete

      echo "âœ… URL æ›¿æ›å®Œæˆ: $OLD_BACKEND_URL â†’ $NEW_BACKEND_URL"

      # é©—è­‰
      REMAINING=$(grep -r 'coach-backend.gamepig1976' --include='*.ts' --include='*.js' --include='*.jsonc' --include='.dev.vars' . --exclude-dir='.git' --exclude-dir='node_modules' --exclude-dir='technical_docs' 2>/dev/null | wc -l)
      echo "âœ… é©—è­‰: å‰©é¤˜èˆŠ URL = $REMAININGï¼ˆæ‡‰ç‚º 0ï¼‰"

      if [ "$REMAINING" -ne 0 ]; then
        echo "âŒ éŒ¯èª¤: é‚„æœ‰ $REMAINING å€‹èˆŠ URL æœªæ›¿æ›"
        exit 1
      fi

phase_2_update_git_config:
  stage: phase_2_automation
  image: node:18-alpine
  needs: ["phase_2_batch_replace_urls"]
  script:
    - |
      echo "Phase 2: AUTO_002 - æ›´æ–° Git ç”¨æˆ¶éƒµç®±"
      git config user.email "$NEW_OWNER"
      git config user.name "CoachRocks Transfer"
      echo "âœ… Git é…ç½®å·²æ›´æ–°: user.email = $NEW_OWNER"

phase_2_update_wrangler_account_id:
  stage: phase_2_automation
  image: node:18-alpine
  needs: ["phase_2_batch_replace_urls"]
  script:
    - |
      echo "Phase 2: AUTO_003 - æ›´æ–° Wrangler Account ID"

      if [ -z "$NEW_ACCOUNT_ID" ]; then
        echo "âŒ éŒ¯èª¤: NEW_ACCOUNT_ID æœªè¨­ç½®"
        exit 1
      fi

      # æ›´æ–° backend/wrangler.jsonc
      sed -i.bak "s/\"account_id\": \"${OLD_ACCOUNT_ID}\"/\"account_id\": \"${NEW_ACCOUNT_ID}\"/g" backend/wrangler.jsonc
      rm -f backend/wrangler.jsonc.bak

      echo "âœ… Account ID å·²æ›´æ–°:"
      grep '"account_id"' backend/wrangler.jsonc

      # é©—è­‰
      if grep -q "$OLD_ACCOUNT_ID" backend/wrangler.jsonc; then
        echo "âŒ éŒ¯èª¤: èˆŠ Account ID é‚„åœ¨æ–‡ä»¶ä¸­"
        exit 1
      fi

phase_2_verify_no_remnants:
  stage: phase_2_automation
  image: node:18-alpine
  needs: ["phase_2_update_wrangler_account_id"]
  script:
    - |
      echo "Phase 2: AUTO_005 - é©—è­‰æ²’æœ‰éºæ¼çš„èˆŠå€¼"
      echo ""

      echo "ğŸ” æª¢æŸ¥ gamepig1976 éºæ¼"
      GAMEPIG_COUNT=$(grep -r 'gamepig1976' --include='*.ts' --include='*.js' --include='*.jsonc' --include='.dev.vars' . --exclude-dir='.git' --exclude-dir='node_modules' --exclude-dir='technical_docs' 2>/dev/null | wc -l)
      echo "   çµæœ: $GAMEPIG_COUNT å€‹åŒ¹é…ï¼ˆæ‡‰ç‚º 0ï¼‰"

      echo ""
      echo "ğŸ” æª¢æŸ¥èˆŠ Account ID éºæ¼"
      ACCOUNT_COUNT=$(grep -r "$OLD_ACCOUNT_ID" --include='*.jsonc' --exclude-dir='.git' . 2>/dev/null | wc -l)
      echo "   çµæœ: $ACCOUNT_COUNT å€‹åŒ¹é…ï¼ˆæ‡‰ç‚º 0ï¼‰"

      echo ""
      echo "ğŸ” æª¢æŸ¥èˆŠ Database ID éºæ¼"
      DB_COUNT=$(grep -r "$OLD_DATABASE_ID" --include='*.jsonc' --exclude-dir='.git' . 2>/dev/null | wc -l)
      echo "   çµæœ: $DB_COUNT å€‹åŒ¹é…ï¼ˆæ‡‰ç‚º 0ï¼‰"

      if [ "$GAMEPIG_COUNT" -ne 0 ] || [ "$ACCOUNT_COUNT" -ne 0 ] || [ "$DB_COUNT" -ne 0 ]; then
        echo ""
        echo "âŒ éŒ¯èª¤: ç™¼ç¾éºæ¼çš„èˆŠå€¼"
        exit 1
      fi

      echo ""
      echo "âœ… æ‰€æœ‰é©—è­‰é€šéï¼"

# ============================================================================
# PHASE 3: Google OAuth & RESEND é…ç½®
# ============================================================================

phase_3_wait_for_oauth_credentials:
  stage: phase_3_oauth_resend
  image: alpine:latest
  needs: ["phase_2_verify_no_remnants"]
  script:
    - |
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘     Phase 3: Google OAuth & RESEND é…ç½®ï¼ˆKatherine æ‰‹å‹•ï¼‰     â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      echo ""
      echo "âš ï¸  è«‹åŸ·è¡Œä»¥ä¸‹æ‰‹å‹•æ­¥é©Ÿï¼š"
      echo ""
      echo "ğŸ” Google OAuth æ†‘è­‰å»ºç«‹"
      echo "   1. å‰å¾€ https://console.cloud.google.com/"
      echo "   2. å»ºç«‹æ–° OAuth 2.0 Client IDï¼ˆWeb Applicationï¼‰"
      echo "   3. Authorized redirect URIs æ·»åŠ ï¼š"
      echo "      https://coach-backend.${NEW_OWNER%.com}.workers.dev/api/auth/google/callback"
      echo "   4. è¤‡è£½ä¸¦è¨­ç½®ä»¥ä¸‹ GitLab Variables:"
      echo "      - GOOGLE_CLIENT_ID"
      echo "      - GOOGLE_CLIENT_SECRET"
      echo ""
      echo "ğŸ“§ RESEND éƒµä»¶æœå‹™"
      echo "   â„¹ï¸  RESEND_API_KEY å°‡å¾èˆŠå¸³æˆ¶è‡ªå‹•è¤‡è£½"
      echo "   â„¹ï¸  é–‹ç™¼ç’°å¢ƒè‡ªå‹•ä½¿ç”¨ onboarding@resend.devï¼ˆç„¡éœ€é©—è­‰ï¼‰"
      echo "   â„¹ï¸  ç”Ÿç”¢ç’°å¢ƒé©—è­‰å¾… Phase 6"
      echo ""
      echo "âœ… è¨­ç½®å®Œæˆå¾Œï¼Œæ‰‹å‹•é»æ“Š 'Play' æŒ‰éˆ•ç¹¼çºŒ"
      echo ""
      echo "Google Client ID å·²è¨­ç½®: ${GOOGLE_CLIENT_ID:-'âŒ æœªè¨­ç½®'}"
  when: manual
  allow_failure: false

phase_3_setup_google_secrets:
  stage: phase_3_oauth_resend
  image: node:18-alpine
  needs: ["phase_3_wait_for_oauth_credentials"]
  script:
    - |
      echo "Phase 3: AUTO_006 - è¨­ç½® Google OAuth Secrets"

      if [ -z "$GOOGLE_CLIENT_ID" ] || [ -z "$GOOGLE_CLIENT_SECRET" ]; then
        echo "âŒ éŒ¯èª¤: GOOGLE_CLIENT_ID æˆ– GOOGLE_CLIENT_SECRET æœªè¨­ç½®"
        exit 1
      fi

      NEW_REDIRECT_URI="https://coach-backend.${NEW_OWNER%.com}.workers.dev/api/auth/google/callback"
      echo "âœ… Google OAuth Secrets å°‡è¨­ç½®ï¼š"
      echo "   - GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID:0:20}..."
      echo "   - GOOGLE_CLIENT_SECRET: ${GOOGLE_CLIENT_SECRET:0:20}..."
      echo "   - GOOGLE_REDIRECT_URI: $NEW_REDIRECT_URI"
      echo ""
      echo "âš ï¸  éœ€è¦åœ¨æ–°å¸³æˆ¶ä¸Šä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤è¨­ç½® Secrets:"
      echo "    cd backend && wrangler secret put GOOGLE_CLIENT_ID"
      echo "    cd backend && wrangler secret put GOOGLE_CLIENT_SECRET"
      echo "    cd backend && wrangler secret put GOOGLE_REDIRECT_URI"

phase_3_setup_resend:
  stage: phase_3_oauth_resend
  image: node:18-alpine
  needs: ["phase_3_setup_google_secrets"]
  script:
    - |
      echo "Phase 3: AUTO_008 - RESEND éƒµä»¶æœå‹™é…ç½®"
      echo ""
      echo "ğŸ“§ RESEND é…ç½®ç‹€æ…‹"
      echo "   âœ… é–‹ç™¼ç’°å¢ƒ: onboarding@resend.devï¼ˆç«‹å³å¯ç”¨ï¼‰"
      echo "   â³ ç”Ÿç”¢ç’°å¢ƒ: noreply@coachrocks.comï¼ˆPhase 6 é©—è­‰ï¼‰"
      echo ""
      echo "âœ… RESEND é…ç½®æº–å‚™å®Œæˆ"

# ============================================================================
# PHASE 4: è³‡æ–™åº«é·ç§»
# ============================================================================

phase_4_wait_for_database_setup:
  stage: phase_4_database
  image: alpine:latest
  needs: ["phase_3_setup_resend"]
  script:
    - |
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘     Phase 4: è³‡æ–™åº«é·ç§»ï¼ˆKatherine æ‰‹å‹•æˆ–è‡ªå‹•ï¼‰              â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      echo ""
      echo "âš ï¸  è«‹é¸æ“‡ä¸€å€‹é¸é …:"
      echo ""
      echo "âœ… é¸é … A: å°å‡ºèˆŠè³‡æ–™åº« + å°å…¥æ–°å¸³æˆ¶ï¼ˆæ¨è–¦ï¼Œä¿ç•™æ•¸æ“šï¼‰"
      echo "   æ­¥é©Ÿï¼š"
      echo "   1. AI åŸ·è¡Œ: wrangler d1 export coachdb > backup.sql"
      echo "   2. ä¸‹è¼‰ backup.sql"
      echo "   3. åœ¨æ–°å¸³æˆ¶å‰µå»ºæ–° D1: coachdb"
      echo "   4. è¤‡è£½ Database ID â†’ è¨­ç½® GitLab Variable: NEW_DATABASE_ID"
      echo "   5. AI åŸ·è¡Œ: wrangler d1 import coachdb backup.sql"
      echo ""
      echo "âš¡ é¸é … B: æ–°å»ºç©ºè³‡æ–™åº«ï¼ˆå¿«é€Ÿï¼Œæœƒéºå¤±æ•¸æ“šï¼‰"
      echo "   æ­¥é©Ÿï¼š"
      echo "   1. åœ¨æ–°å¸³æˆ¶å‰µå»ºæ–° D1: coachdb"
      echo "   2. è¤‡è£½ Database ID â†’ è¨­ç½® GitLab Variable: NEW_DATABASE_ID"
      echo "   3. åˆå§‹åŒ–è³‡æ–™åº«çµæ§‹"
      echo ""
      echo "âœ… é¸æ“‡å®Œæˆä¸¦è¨­ç½® NEW_DATABASE_ID å¾Œï¼Œæ‰‹å‹•é»æ“Š 'Play' æŒ‰éˆ•ç¹¼çºŒ"
      echo ""
      echo "Database ID å·²è¨­ç½®: ${NEW_DATABASE_ID:-'âŒ æœªè¨­ç½®'}"
  when: manual
  allow_failure: false

phase_4_update_database_id:
  stage: phase_4_database
  image: node:18-alpine
  needs: ["phase_4_wait_for_database_setup"]
  script:
    - |
      echo "Phase 4: AUTO_008 (ä¿®æ”¹ç‰ˆ) - æ›´æ–°è³‡æ–™åº« ID"

      if [ -z "$NEW_DATABASE_ID" ]; then
        echo "âŒ éŒ¯èª¤: NEW_DATABASE_ID æœªè¨­ç½®"
        exit 1
      fi

      sed -i.bak "s/\"database_id\": \"${OLD_DATABASE_ID}\"/\"database_id\": \"${NEW_DATABASE_ID}\"/g" backend/wrangler.jsonc
      rm -f backend/wrangler.jsonc.bak

      echo "âœ… Database ID å·²æ›´æ–°:"
      grep '"database_id"' backend/wrangler.jsonc

      if grep -q "$OLD_DATABASE_ID" backend/wrangler.jsonc; then
        echo "âŒ éŒ¯èª¤: èˆŠ Database ID é‚„åœ¨æ–‡ä»¶ä¸­"
        exit 1
      fi

# ============================================================================
# PHASE 5: é©—è­‰å’Œéƒ¨ç½²
# ============================================================================

phase_5_final_verification:
  stage: phase_5_deployment
  image: node:18-alpine
  needs: ["phase_4_update_database_id"]
  script:
    - |
      echo "Phase 5: VERIFY_001 ~ VERIFY_003 - æœ€çµ‚é©—è­‰"
      echo ""

      echo "ğŸ” é©—è­‰ 1: ä»£ç¢¼ä¸­ç„¡ç¡¬ç·¨ç¢¼èˆŠå€¼"
      echo "   æª¢æŸ¥ gamepig1976..."
      GAMEPIG=$(grep -r 'gamepig1976' --include='*.ts' --include='*.js' --include='*.jsonc' --include='.dev.vars' . --exclude-dir='.git' --exclude-dir='node_modules' --exclude-dir='technical_docs' 2>/dev/null | wc -l)
      echo "     çµæœ: $GAMEPIGï¼ˆæ‡‰ç‚º 0ï¼‰"

      echo "   æª¢æŸ¥èˆŠ Account ID..."
      ACCOUNT=$(grep -r "$OLD_ACCOUNT_ID" --include='*.ts' --include='*.jsonc' . --exclude-dir='.git' 2>/dev/null | wc -l)
      echo "     çµæœ: $ACCOUNTï¼ˆæ‡‰ç‚º 0ï¼‰"

      echo "   æª¢æŸ¥èˆŠ Database ID..."
      DATABASE=$(grep -r "$OLD_DATABASE_ID" --include='*.jsonc' . --exclude-dir='.git' 2>/dev/null | wc -l)
      echo "     çµæœ: $DATABASEï¼ˆæ‡‰ç‚º 0ï¼‰"

      if [ "$GAMEPIG" -ne 0 ] || [ "$ACCOUNT" -ne 0 ] || [ "$DATABASE" -ne 0 ]; then
        echo "âŒ é©—è­‰å¤±æ•—"
        exit 1
      fi
      echo "âœ… é©—è­‰ 1 é€šé"
      echo ""

      echo "ğŸ” é©—è­‰ 2: é…ç½®æª”æ¡ˆæ­£ç¢º"
      echo "   æª¢æŸ¥ backend/wrangler.jsonc..."
      grep -E 'account_id|database_id|"name"' backend/wrangler.jsonc
      echo "âœ… é©—è­‰ 2 é€šé"
      echo ""

      echo "âœ… æ‰€æœ‰é©—è­‰é€šéï¼Œæº–å‚™æ§‹å»º"

phase_5_build_backend:
  stage: phase_5_deployment
  image: node:18-alpine
  needs: ["phase_5_final_verification"]
  script:
    - |
      echo "Phase 5: å¾Œç«¯æ§‹å»º"
      cd backend
      npm ci
      npm run type-check || true
      echo "âœ… å¾Œç«¯æ§‹å»ºæˆåŠŸ"
  artifacts:
    paths:
      - backend/dist
    expire_in: 1 week

phase_5_build_frontend:
  stage: phase_5_deployment
  image: node:18-alpine
  needs: ["phase_5_final_verification"]
  script:
    - |
      echo "Phase 5: å‰ç«¯æ§‹å»º"
      cd frontend
      npm ci
      npm run build
      echo "âœ… å‰ç«¯æ§‹å»ºæˆåŠŸ"
  artifacts:
    paths:
      - frontend/dist
    expire_in: 1 week

phase_5_deployment_summary:
  stage: phase_5_deployment
  image: alpine:latest
  needs: ["phase_5_build_backend", "phase_5_build_frontend"]
  script:
    - |
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘            ğŸ‰ è‡ªå‹•åŒ–è½‰ç§»å®Œæˆï¼ä¸‹ä¸€æ­¥ï¼šéƒ¨ç½²                   â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      echo ""
      echo "âœ… å·²å®Œæˆçš„è‡ªå‹•åŒ–æ“ä½œï¼š"
      echo "   âœ“ URL æ‰¹é‡æ›´æ–°ï¼ˆAUTO_001ï¼‰"
      echo "   âœ“ Git é…ç½®æ›´æ–°ï¼ˆAUTO_002ï¼‰"
      echo "   âœ“ Wrangler Account ID æ›´æ–°ï¼ˆAUTO_003ï¼‰"
      echo "   âœ“ é©—è­‰æ²’æœ‰éºæ¼ï¼ˆAUTO_005ï¼‰"
      echo "   âœ“ Database ID æ›´æ–°ï¼ˆAUTO_008ï¼‰"
      echo "   âœ“ æœ€çµ‚ä»£ç¢¼é©—è­‰ï¼ˆVERIFY_001-002ï¼‰"
      echo "   âœ“ å¾Œç«¯å’Œå‰ç«¯æ§‹å»º"
      echo ""
      echo "ğŸ“¦ ç·¨è­¯ç”¢ç‰©å·²ä¿å­˜åœ¨ Artifacts ä¸­"
      echo ""
      echo "âš ï¸  æœ€å¾Œæ­¥é©Ÿï¼ˆéƒ¨ç½²åˆ° Cloudflareï¼‰éœ€è¦åœ¨æœ¬åœ°åŸ·è¡Œï¼š"
      echo ""
      echo "1ï¸âƒ£  ä¸‹è¼‰ç·¨è­¯ç”¢ç‰©ï¼ˆå¦‚éœ€è¦ï¼‰"
      echo ""
      echo "2ï¸âƒ£  è¨­ç½® Cloudflare èªè­‰"
      echo "    export CLOUDFLARE_API_TOKEN=xxx"
      echo "    export CLOUDFLARE_ACCOUNT_ID=${NEW_ACCOUNT_ID}"
      echo ""
      echo "3ï¸âƒ£  éƒ¨ç½²å¾Œç«¯ï¼š"
      echo "    cd backend && wrangler deploy"
      echo ""
      echo "4ï¸âƒ£  éƒ¨ç½²å‰ç«¯ï¼š"
      echo "    cd frontend && wrangler pages deploy dist --project-name=coach-rocks-frontend"
      echo ""
      echo "5ï¸âƒ£  é©—è­‰éƒ¨ç½²ï¼š"
      echo "    curl -s https://coach-backend.katherine84522.workers.dev/api/health | jq ."
      echo ""
      echo "ğŸ“§ Google OAuth å’Œ RESEND Secrets è¨­ç½®ï¼š"
      echo "    # åœ¨å¾Œç«¯ç›®éŒ„åŸ·è¡Œ"
      echo "    wrangler secret put GOOGLE_CLIENT_ID"
      echo "    wrangler secret put GOOGLE_CLIENT_SECRET"
      echo "    wrangler secret put GOOGLE_REDIRECT_URI"
      echo "    wrangler secret put RESEND_API_KEY"
      echo ""
      echo "âœ¨ è½‰ç§»éç¨‹å·²å®Œå…¨è‡ªå‹•åŒ–ï¼"
